<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - Passagem de Turno</title>
<style>
body { font-family: Arial, sans-serif; background:#f5f5f5; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
.container { background:#fff; padding:30px; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.1); width:300px; }
h2 { text-align:center; color:#2d6a4f; }
input { width:100%; padding:8px; margin-bottom:12px; border:1px solid #ccc; border-radius:4px; }
button { width:100%; padding:10px; border:none; background:#95d5b2; color:#fff; font-size:16px; border-radius:4px; cursor:pointer; }
button:hover { background:#74c69d; }
#msg { text-align:center; margin-bottom:10px; color:red; font-size:14px; }
</style>
</head>
<body>
<div class="container">
<h2>Login</h2>
<div id="msg"></div>
<input type="text" id="nome" placeholder="Nome (para cadastro)">
<input type="text" id="matricula" placeholder="Matrícula">
<button id="btnLogin">Login</button>
<button id="btnCadastrar">Cadastrar</button>
<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwFS6gRrIGYeWFZ9KYjSaOMLfJd_TTsrZcLNGyvdb7R0RZBcXrQUlgLUdAjNr7B58o/exec";

async function postData(payload){
  try{
    const resp = await fetch(SCRIPT_URL,{method:"POST",body:JSON.stringify(payload)});
    return await resp.json();
  }catch(err){
    console.error(err);
    return {success:false,message:"Erro ao conectar com servidor"};
  }
}

document.getElementById("btnLogin").addEventListener("click", async ()=>{
  const matricula = document.getElementById("matricula").value.trim();
  if(!matricula){ showMsg("Digite sua matrícula"); return; }
  const data = await postData({login:true, matricula});
  if(data.success){
    localStorage.setItem("nome", data.nome);
    localStorage.setItem("matricula", matricula);
    window.location.href = "index.html";
  }else showMsg(data.message);
});

document.getElementById("btnCadastrar").addEventListener("click", async ()=>{
  const nome = document.getElementById("nome").value.trim();
  const matricula = document.getElementById("matricula").value.trim();
  if(!nome || !matricula){ showMsg("Preencha nome e matrícula"); return; }
  const data = await postData({cadastrar:true, nome, matricula});
  showMsg(data.message);
});

function showMsg(msg){ 
  const div = document.getElementById("msg");
  div.innerText = msg;
  setTimeout(()=>{ div.innerText=""; },3000);
}
</script>
</div>
</body>
</html>
