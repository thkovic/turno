<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Passagem de Turno</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f9f9f9; }
.container { max-width: 900px; margin: 30px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
h1 { text-align: center; margin-bottom: 20px; }
label { font-weight: bold; margin-top: 10px; display: block; }
input, textarea, select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; }
button { background: #007bff; color: white; border: none; cursor: pointer; margin-top: 20px; }
button:hover { background: #0056b3; }
.success { color: green; margin-top: 10px; text-align: center; }
.error { color: red; margin-top: 10px; text-align: center; }
</style>
</head>
<body>
<div class="container">
  <h1>Registro de Passagem de Turno</h1>

  <label>Data da Ocorrência:</label>
  <input type="text" id="dataOcorrencia" placeholder="Ex: 2025-10-20">

  <label>Operador:</label>
  <input type="text" id="operador">

  <label>Matrícula:</label>
  <input type="text" id="matricula">

  <label>Equipamento:</label>
  <input type="text" id="equipamento">

  <label>Acionamento:</label>
  <input type="text" id="acionamento">

  <label>Problema:</label>
  <textarea id="problema"></textarea>

  <label>Solução:</label>
  <textarea id="solucao"></textarea>

  <label>Encerramento:</label>
  <input type="text" id="encerramento">

  <button onclick="enviarRegistro()">Enviar Registro</button>

  <p id="msg" class="success"></p>
</div>

<script>
async function enviarRegistro() {
  const dados = {
    dataOcorrencia: document.getElementById('dataOcorrencia').value.trim(),
    operador: document.getElementById('operador').value.trim(),
    matricula: document.getElementById('matricula').value.trim(),
    equipamento: document.getElementById('equipamento').value.trim(),
    acionamento: document.getElementById('acionamento').value.trim(),
    problema: document.getElementById('problema').value.trim(),
    solucao: document.getElementById('solucao').value.trim(),
    encerramento: document.getElementById('encerramento').value.trim()
  };

  const msg = document.getElementById('msg');
  msg.textContent = "Enviando...";

  try {
    const response = await fetch("https://script.google.com/macros/s/SEU_SCRIPT_ID_AQUI/exec", {
      method: "POST",
      body: JSON.stringify(dados)
    });

    const result = await response.json();

    if (result.status === "success") {
      msg.textContent = "✅ Registro enviado com sucesso!";
      msg.className = "success";
    } else {
      msg.textContent = "❌ Erro ao enviar o registro.";
      msg.className = "error";
    }
  } catch (e) {
    msg.textContent = "⚠️ Falha de conexão com o servidor.";
    msg.className = "error";
  }
}
</script>
</body>
</html>
