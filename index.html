<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sistema Passagem de Turno - Nova Vers√£o</title>
<style>
body { font-family: Arial, sans-serif; margin:20px; background:#f5f5f5; }
.container { max-width:1000px; margin:0 auto; background:white; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
button { background:#2d6a4f; color:white; border:none; padding:10px 15px; margin:5px; border-radius:5px; cursor:pointer; }
button:hover { background:#1b4332; }
.alert { padding:10px; margin:10px 0; border-radius:5px; }
.success { background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
.error { background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
.info { background:#d1ecf1; color:#0c5460; border:1px solid #bee5eb; }
.hidden { display:none; }
</style>
</head>
<body>
<div class="container">
    <h1>üéØ Sistema Passagem de Turno - NOVA VERS√ÉO</h1>
    
    <div class="alert info">
        <strong>‚ö†Ô∏è IMPORTANTE:</strong> Esta √© a NOVA vers√£o com comandos diferentes!
    </div>

    <h2>üß™ Testes da Nova Vers√£o</h2>
    
    <button onclick="testeConexao()">1. Testar Conex√£o</button>
    <button onclick="testeLogin()">2. Testar Login (81057898)</button>
    <button onclick="testeCadastro()">3. Testar Cadastro</button>
    <button onclick="testeHistorico()">4. Testar Hist√≥rico</button>
    <button onclick="testeTurno()">5. Testar Turno</button>
    <button onclick="limparResultados()" style="background:#6c757d;">Limpar</button>
    
    <div id="resultados" style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:5px; min-height:100px;"></div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwFS6gRrIGYeWFZ9KYjSaOMLfJd_TTsrZcLNGyvdb7R0RZBcXrQUlgLUdAjNr7B58o/exec";

async function enviarComando(comando) {
    try {
        console.log("üì§ Enviando:", comando);
        const resposta = await fetch(SCRIPT_URL, {
            method: "POST",
            body: JSON.stringify(comando)
        });
        const dados = await resposta.json();
        console.log("üì• Resposta:", dados);
        return dados;
    } catch (erro) {
        console.error("‚ùå Erro:", erro);
        throw erro;
    }
}

function mostrarResultado(titulo, dados) {
    const div = document.getElementById('resultados');
    const resultado = document.createElement('div');
    resultado.className = dados.sucesso !== false ? 'alert success' : 'alert error';
    resultado.innerHTML = `<strong>${titulo}</strong><br><pre>${JSON.stringify(dados, null, 2)}</pre>`;
    div.appendChild(resultado);
}

async function testeConexao() {
    try {
        const resposta = await fetch(SCRIPT_URL);
        const dados = await resposta.json();
        mostrarResultado("üîó Teste de Conex√£o", dados);
    } catch (erro) {
        mostrarResultado("üîó Teste de Conex√£o", { erro: erro.message });
    }
}

async function testeLogin() {
    const resultado = await enviarComando({
        acao: "login",
        matricula: "81057898"
    });
    mostrarResultado("üîê Teste de Login", resultado);
}

async function testeCadastro() {
    const resultado = await enviarComando({
        acao: "cadastrar_usuario",
        nome: "Usuario Teste Nova Vers√£o",
        matricula: "TESTE" + Date.now()
    });
    mostrarResultado("üë§ Teste de Cadastro", resultado);
}

async function testeHistorico() {
    const resultado = await enviarComando({
        acao: "buscar_historico"
    });
    mostrarResultado("üìä Teste de Hist√≥rico", Array.isArray(resultado) ? 
        { registros_encontrados: resultado.length, dados: resultado.slice(0, 3) } : resultado);
}

async function testeTurno() {
    const resultado = await enviarComando({
        acao: "registrar_turno",
        nome: "Testador",
        matricula: "12345",
        equipamento: "EQUIP-TESTE-NOVA-VERSAO",
        acionamento: "08:00",
        problema: "Problema de teste",
        solucao: "Solu√ß√£o aplicada",
        encerramento: "09:00"
    });
    mostrarResultado("üìù Teste de Turno", resultado);
}

function limparResultados() {
    document.getElementById('resultados').innerHTML = '';
}

// Teste autom√°tico
setTimeout(() => {
    mostrarResultado("üöÄ Sistema Pronto", { 
        mensagem: "Clique nos bot√µes para testar a NOVA vers√£o",
        comandos: ["login", "cadastrar_usuario", "buscar_historico", "registrar_turno"]
    });
}, 1000);
</script>
</body>
</html>
