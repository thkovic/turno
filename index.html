<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Teste Final</title>
</head>
<body>
    <h1>Teste Final</h1>
    <button onclick="testar()">Testar Tudo</button>
    <div id="result"></div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbwFS6gRrIGYeWFZ9KYjSaOMLfJd_TTsrZcLNGyvdb7R0RZBcXrQUlgLUdAjNr7B58o/exec";

async function testar() {
    const result = document.getElementById('result');
    
    try {
        // Teste 1: Conexão básica
        result.innerHTML = "Testando conexão...<br>";
        const conexao = await fetch(URL);
        const dadosConexao = await conexao.json();
        result.innerHTML += "Conexão: " + JSON.stringify(dadosConexao) + "<br><br>";
        
        // Teste 2: Histórico
        result.innerHTML += "Testando histórico...<br>";
        const historico = await fetch(URL, {
            method: 'POST',
            body: JSON.stringify({ getHistory: true })
        });
        const dadosHistorico = await historico.json();
        result.innerHTML += "Histórico: " + JSON.stringify(dadosHistorico) + "<br>";
        
    } catch (erro) {
        result.innerHTML += "ERRO: " + erro.message;
    }
}
</script>
</body>
</html>
